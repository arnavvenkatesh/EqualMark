<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EqualMark: Precision Division & Layout Visualizer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0a0e17;
      --surface: #141922;
      --surface-elevated: #1a1f2e;
      --border: #2a3341;
      --text-primary: #e4e7eb;
      --text-secondary: #9ca3af;
      --text-tertiary: #6b7280;
      --accent: #3b82f6;
      --accent-hover: #2563eb;
      --success: #10b981;
      --error: #ef4444;
      --mono: 'JetBrains Mono', 'Courier New', monospace;
      --sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    html, body {
      height: 100%;
      background: var(--bg);
      color: var(--text-primary);
      font-family: var(--sans);
      line-height: 1.6;
    }
    
    body {
      display: flex;
      flex-direction: column;
      padding: 2rem 1.5rem 2rem;
    }
    
    .container {
      max-width: 1200px;
      width: 100%;
      margin: 0 auto;
    }
    
    /* Header */
    header {
      margin-bottom: 2rem;
      border-bottom: 1px solid var(--border);
      padding-bottom: 1.5rem;
    }
    
    h1 {
      font-size: 1.5rem;
      font-weight: 600;
      letter-spacing: -0.02em;
      margin-bottom: 0.5rem;
    }
    
    .subtitle {
      color: var(--text-secondary);
      font-size: 0.875rem;
      font-weight: 400;
    }
    
    /* Grid Layout */
    .grid {
      display: grid;
      grid-template-columns: 380px 1fr;
      gap: 1.5rem;
    }
    
    /* Panel Styling */
    .panel {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1.5rem;
    }
    
    .panel-title {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--text-tertiary);
      font-weight: 600;
      margin-bottom: 1rem;
    }
    
    /* Form Controls */
    .form-group {
      margin-bottom: 1.25rem;
    }
    
    .form-group:last-child {
      margin-bottom: 0;
    }
    
    label {
      display: block;
      font-size: 0.8125rem;
      color: var(--text-secondary);
      margin-bottom: 0.5rem;
      font-weight: 500;
    }
    
    .input-row {
      display: flex;
      gap: 0.5rem;
    }
    
    input[type="number"],
    select {
      width: 100%;
      background: var(--surface-elevated);
      border: 1px solid var(--border);
      color: var(--text-primary);
      padding: 0.625rem 0.75rem;
      border-radius: 6px;
      font-size: 0.875rem;
      font-family: var(--mono);
      transition: border-color 0.2s, background 0.2s;
    }
    
    input[type="number"]:focus,
    select:focus {
      outline: none;
      border-color: var(--accent);
      background: var(--bg);
    }
    
    input[type="number"].error {
      border-color: var(--error);
    }
    
    select {
      cursor: pointer;
      font-family: var(--sans);
    }
    
    /* Buttons */
    .button-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.5rem;
      margin-top: 1.5rem;
    }
    
    button {
      padding: 0.625rem 1rem;
      border-radius: 6px;
      font-size: 0.8125rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      border: 1px solid transparent;
      font-family: var(--sans);
    }
    
    button.primary {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }
    
    button.primary:hover {
      background: var(--accent-hover);
      border-color: var(--accent-hover);
    }
    
    button.secondary {
      background: transparent;
      color: var(--text-secondary);
      border-color: var(--border);
    }
    
    button.secondary:hover {
      background: var(--surface-elevated);
      color: var(--text-primary);
    }
    
    /* Error Message */
    .error-message {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid var(--error);
      color: var(--error);
      padding: 0.75rem;
      border-radius: 6px;
      font-size: 0.8125rem;
      margin-top: 0.75rem;
      display: none;
    }
    
    .error-message.show {
      display: block;
    }
    
    /* Output Display */
    .output-section {
      margin-top: 1.5rem;
      padding-top: 1.5rem;
      border-top: 1px solid var(--border);
    }
    
    pre {
      background: var(--bg);
      border: 1px solid var(--border);
      color: var(--text-primary);
      padding: 1rem;
      border-radius: 6px;
      overflow-x: auto;
      font-size: 0.8125rem;
      font-family: var(--mono);
      line-height: 1.8;
      max-height: 300px;
      overflow-y: auto;
    }
    
    /* Visualization Panel */
    .viz-panel {
      display: flex;
      flex-direction: column;
      min-height: 400px;
    }
    
    .scale-container {
      flex: 1;
      background: var(--surface-elevated);
      border-radius: 6px;
      padding: 2rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    #scale {
      max-width: 100%;
      height: auto;
    }
    
    .viz-info {
      margin-top: 1rem;
      padding: 0.75rem;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 6px;
      font-size: 0.75rem;
      color: var(--text-tertiary);
      line-height: 1.6;
    }
    
    .viz-info ul {
      margin: 0.5rem 0 0 1.25rem;
    }
    
    .viz-info li {
      margin-bottom: 0.25rem;
    }
    
    code {
      background: var(--surface);
      padding: 0.125rem 0.375rem;
      border-radius: 3px;
      font-family: var(--mono);
      font-size: 0.7rem;
    }
    
    /* Footer */
    footer {
      margin-top: 3rem;
      padding: 1.5rem 0;
      font-size: 0.6875rem;
      color: var(--text-tertiary);
      text-align: center;
      border-top: 1px solid var(--border);
    }
    
    footer strong {
      color: var(--text-secondary);
      font-weight: 600;
    }
    
    /* Responsive */
    @media (max-width: 900px) {
      .grid {
        grid-template-columns: 1fr;
      }
      
      body {
        padding: 1.5rem 1rem 1.5rem;
      }
    }
    
    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: var(--surface);
    }
    
    ::-webkit-scrollbar-thumb {
      background: var(--border);
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: var(--text-tertiary);
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>EqualMark</h1>
      <p class="subtitle">Precision Division & Layout Visualizer: Engineering utility for computing and visualizing tick marks</p>
    </header>

    <div class="grid">
      <!-- Control Panel -->
      <div class="panel">
        <div class="panel-title">Parameters</div>
        
        <div class="form-group">
          <label for="divisions">Number of Divisions</label>
          <input id="divisions" type="number" min="1" value="5" />
        </div>

        <div class="form-group">
          <label for="length">Total Length</label>
          <div class="input-row">
            <input id="length" type="number" min="0" step="any" value="8" style="flex: 2;" />
            <select id="unit" style="flex: 1;">
              <option value="cm">cm</option>
              <option value="mm">mm</option>
              <option value="in">in</option>
              <option value="px">px</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="precision">Display Precision</label>
          <select id="precision">
            <option value="auto">Auto (2 dp)</option>
            <option value="1">1 decimal place</option>
            <option value="2" selected>2 decimal places</option>
            <option value="3">3 decimal places</option>
          </select>
        </div>

        <div class="form-group">
          <label for="fraction">Fraction Mode (inches only)</label>
          <select id="fraction">
            <option value="none">Decimal</option>
            <option value="8">1/8"</option>
            <option value="16" selected>1/16"</option>
            <option value="32">1/32"</option>
          </select>
        </div>

        <div class="error-message" id="errorMsg"></div>

        <div class="button-group">
          <button id="compute" class="primary">Compute</button>
          <button id="copy" class="secondary">Copy Values</button>
          <button id="download" class="secondary">Download SVG</button>
          <button id="print" class="secondary">Print</button>
        </div>

        <div class="output-section">
          <div class="panel-title">Tick Values</div>
          <pre id="ticks">—</pre>
        </div>
      </div>

      <!-- Visualization Panel -->
      <div class="panel viz-panel">
        <div class="panel-title">Visualization</div>
        <div class="scale-container">
          <svg id="scale" width="100%" height="140" viewBox="0 0 900 140" preserveAspectRatio="xMinYMid meet"></svg>
        </div>
        <div class="viz-info">
          <strong>Notes:</strong>
          <ul>
            <li>Values are rounded for display only; calculations use full precision</li>
            <li>Fraction mode applies rational approximation for <code>inches</code> unit</li>
            <li>SVG scales proportionally; download for print-ready output at specified dimensions</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <strong>EqualMark</strong>: Precision Division & Layout Visualizer | 
    Created by <strong>Arnav Venkatesh</strong>, inspired by a simple frustration while drawing tables in his physics record book
  </footer>

<script>
// Core computation logic
function computeTicks(L, n) {
  if (!isFinite(L) || n <= 0) return [];
  const step = L / n;
  const ticks = [];
  for (let k = 0; k <= n; k++) ticks.push(k * step);
  return ticks;
}

// Rational approximation using continued fraction
function bestFraction(x, maxDen) {
  if (!isFinite(x)) return {num:0, den:1};
  let best = {num: Math.round(x * maxDen), den: maxDen};
  let minErr = Math.abs(x - best.num / best.den);
  for (let d = 1; d <= maxDen; d++) {
    const n = Math.round(x * d);
    const err = Math.abs(x - n / d);
    if (err < minErr) { 
      minErr = err; 
      best = {num:n, den:d}; 
    }
  }
  const g = gcd(Math.abs(best.num), best.den);
  return {num: best.num/g, den: best.den/g};
}

function gcd(a, b) {
  return b === 0 ? a : gcd(b, a % b);
}

function formatValue(v, unit, precision, fracMode) {
  if (unit === 'in' && fracMode !== 'none') {
    const whole = Math.floor(v);
    const frac = v - whole;
    const maxDen = parseInt(fracMode, 10);
    const f = bestFraction(frac, maxDen);
    if (f.num === 0) return `${whole} in`;
    return `${whole} ${Math.abs(f.num)}/${f.den} in`;
  }
  if (precision === 'auto') precision = 2;
  return `${Number(v.toFixed(Number(precision)))} ${unit}`;
}

function renderScale(ticks, unit) {
  const svg = document.getElementById('scale');
  const W = 900; 
  const H = 140; 
  svg.setAttribute('viewBox', `0 0 ${W} ${H}`);
  svg.setAttribute('height', '140');
  
  while(svg.firstChild) svg.removeChild(svg.firstChild);
  
  // Add subtle background rect
  const bg = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
  bg.setAttribute('width', W);
  bg.setAttribute('height', H);
  bg.setAttribute('fill', '#0f1419');
  svg.appendChild(bg);
  
  const padding = 60; 
  const x0 = padding; 
  const x1 = W - padding; 
  const y = 70;
  const Lpx = x1 - x0;
  
  // Main line with slight glow effect
  const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
  line.setAttribute('x1', x0); 
  line.setAttribute('y1', y);
  line.setAttribute('x2', x1); 
  line.setAttribute('y2', y);
  line.setAttribute('stroke', '#3b82f6'); 
  line.setAttribute('stroke-width', 2.5);
  line.setAttribute('stroke-linecap', 'round');
  svg.appendChild(line);
  
  // Tick marks
  const n = ticks.length - 1;
  for (let k = 0; k <= n; k++) {
    const x = x0 + (k / n) * Lpx;
    const isMajor = (k % Math.max(1, Math.floor(n/10)) === 0) || k === 0 || k === n;
    const isEnd = k === 0 || k === n;
    const h = isEnd ? 32 : (isMajor ? 24 : 12);
    const strokeWidth = isEnd ? 2.5 : (isMajor ? 2 : 1.5);
    const color = isEnd ? '#3b82f6' : '#e4e7eb';
    
    const tick = document.createElementNS('http://www.w3.org/2000/svg', 'line');
    tick.setAttribute('x1', x); 
    tick.setAttribute('y1', y - h/2);
    tick.setAttribute('x2', x); 
    tick.setAttribute('y2', y + h/2);
    tick.setAttribute('stroke', color); 
    tick.setAttribute('stroke-width', strokeWidth);
    tick.setAttribute('stroke-linecap', 'round');
    svg.appendChild(tick);
    
    if (isMajor) {
      const txt = document.createElementNS('http://www.w3.org/2000/svg', 'text');
      txt.setAttribute('x', x);
      txt.setAttribute('y', y + h/2 + 20);
      txt.setAttribute('font-size', isEnd ? 16 : 14);
      txt.setAttribute('font-family', 'JetBrains Mono, monospace');
      txt.setAttribute('text-anchor', 'middle');
      txt.setAttribute('fill', isEnd ? '#e4e7eb' : '#9ca3af');
      txt.setAttribute('font-weight', isEnd ? '600' : '400');
      svg.appendChild(txt);
    }
  }
}

function downloadSVG(filename) {
  const svg = document.getElementById('scale');
  const serializer = new XMLSerializer();
  const source = serializer.serializeToString(svg);
  const blob = new Blob([source], {type:'image/svg+xml;charset=utf-8'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; 
  a.download = filename || 'scale.svg';
  document.body.appendChild(a); 
  a.click(); 
  a.remove();
  URL.revokeObjectURL(url);
}

// UI Controller
const el = id => document.getElementById(id);

function showError(message, field = null) {
  const errorMsg = el('errorMsg');
  errorMsg.textContent = message;
  errorMsg.classList.add('show');
  
  if (field) {
    field.classList.add('error');
  }
  
  setTimeout(() => {
    errorMsg.classList.remove('show');
    if (field) field.classList.remove('error');
  }, 4000);
}

function validateInputs() {
  const divisionsInput = el('divisions');
  const lengthInput = el('length');
  const n = Number(divisionsInput.value);
  const L = Number(lengthInput.value);
  
  // Check if fields are empty
  if (divisionsInput.value.trim() === '' || lengthInput.value.trim() === '') {
    showError('⚠️ Please fill in all required fields.', divisionsInput.value.trim() === '' ? divisionsInput : lengthInput);
    return false;
  }
  
  // Check for negative divisions
  if (n < 0) {
    showError('⚠️ Number of divisions cannot be negative. Please enter a positive integer.', divisionsInput);
    return false;
  }
  
  // Check for zero divisions
  if (n === 0) {
    showError('⚠️ Cannot divide into zero parts. Please enter at least 1 division.', divisionsInput);
    return false;
  }
  
  // Check if divisions is not an integer
  if (!Number.isInteger(n)) {
    showError('⚠️ Number of divisions must be a whole number (e.g., 5, not 5.5).', divisionsInput);
    return false;
  }
  
  // Check for negative or zero length
  if (L <= 0) {
    showError('⚠️ Total length must be greater than zero. Please enter a positive value.', lengthInput);
    return false;
  }
  
  // Check for unreasonably large divisions
  if (n > 1000) {
    showError('⚠️ Too many divisions (max 1000). That\'s a bit excessive, don\'t you think?', divisionsInput);
    return false;
  }
  
  // Check for unreasonably large length
  if (L > 1000000) {
    showError('⚠️ Length value too large. Please enter a reasonable measurement.', lengthInput);
    return false;
  }
  
  // Check for invalid numbers (NaN, Infinity)
  if (!Number.isFinite(n) || !Number.isFinite(L)) {
    showError('⚠️ Invalid input detected. Please enter valid numbers only.');
    return false;
  }
  
  return true;
}

function updateAll() {
  // Validate inputs first
  if (!validateInputs()) {
    return;
  }
  
  const n = Number(el('divisions').value);
  const L = Number(el('length').value);
  const unit = el('unit').value;
  const precision = el('precision').value;
  const fraction = el('fraction').value;
  
  const ticks = computeTicks(L, n);
  const list = ticks.map(t => formatValue(t, unit, precision, fraction));
  el('ticks').innerText = list.join('\n');
  
  renderScale(ticks, unit);
  
  // Add labels to major ticks
  const svg = document.getElementById('scale');
  const texts = svg.querySelectorAll('text');
  let labelIndexStep = Math.max(1, Math.floor((ticks.length-1)/texts.length));
  if (labelIndexStep === 0) labelIndexStep = 1;
  
  let tiI = 0;
  texts.forEach(tnode => {
    const idx = Math.min(tiI * labelIndexStep, ticks.length-1);
    tnode.textContent = formatValue(ticks[idx], unit, precision, fraction);
    tiI++;
  });
}

// Event Listeners
el('compute').addEventListener('click', updateAll);

el('copy').addEventListener('click', () => {
  const txt = el('ticks').innerText;
  if (txt === '—' || txt.startsWith('Error:')) {
    showError('⚠️ Nothing to copy. Please compute values first.');
    return;
  }
  
  navigator.clipboard.writeText(txt).then(() => {
    const btn = el('copy');
    const original = btn.textContent;
    btn.textContent = 'Copied ✓';
    setTimeout(() => btn.textContent = original, 1200);
  }).catch(() => {
    alert('Clipboard copy failed — select and copy manually.');
  });
});

el('download').addEventListener('click', () => {
  const txt = el('ticks').innerText;
  if (txt === '—' || txt.startsWith('Error:')) {
    showError('⚠️ Nothing to download. Please compute values first.');
    return;
  }
  downloadSVG('scale.svg');
});

el('print').addEventListener('click', () => window.print());

// Clear error on input
el('divisions').addEventListener('input', () => {
  el('divisions').classList.remove('error');
});

el('length').addEventListener('input', () => {
  el('length').classList.remove('error');
});

// Initialize
updateAll();
</script>

</body>
</html>